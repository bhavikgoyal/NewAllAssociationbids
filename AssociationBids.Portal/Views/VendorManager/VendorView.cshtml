@model AssociationBids.Portal.Model.VendorManagerModel
@using AssociationBids.Portal.Common
@{
    ViewBag.Title = "View Vendor Details";
    Layout = "~/Views/Shared/_Layout.cshtml";

    if (Session["PortalKey"] == null)
    { Response.Redirect("~/", true); }
    else if (Session["PortalKey"].ToString() == "2")
    { Response.Redirect("~/PMDashboard/Dashboard", true); }
    else if (Session["PortalKey"].ToString() == "3")
    { Response.Redirect("~/VDashboard/Index", true); }
}
<script src="~/Scripts/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDXnGGS4mlkx0DnmdnFUVLQ-0i58GSknZ8&sensor=true"></script>
<script src="~/Scripts/Registration/RegistrationValidation.js"></script>
<script src="~/Content/themes/chosen.jquery.min.js"></script>
<link href="~/Content/themes/chosen.min.css" rel="stylesheet" />
<script src="~/assets/plugins/fileuploads/js/dropify.js"></script>
<script src="~/assets/plugins/fileuploads/js/dropify-demo.js"></script>
<script src="~/assets/plugins/fileuploads/js/dropify.min.js"></script>
<style>
    div#ManagerChoosen_chosen {
        width: 100% !important;
    }

    .selector_ED {
        width: auto !important;
    }



    /*.chosen-container-multi .chosen-choices li.search-choice .search-choice-close {
        background: url('../../Content/themes/cancelimg.jpg');
    }*/

    .chosen-select placeholder_text {
        padding: 5px;
    }

    .Error {
        color: red;
    }
</style>

<style>
    .myModal {
        width: 60%;
        margin: auto;
        margin-top: 30px;
        margin-bottom: 30px;
    }
</style>
<h2>VendorView</h2>

<!-- app-content-->
<div class="app-content  my-3 my-md-5">
    <div class="side-app">

        <!-- page-header -->
        <div class="page-header">
            <ol class="breadcrumb">
                <!-- breadcrumb -->
                <li class="breadcrumb-item"><a href="../Dashboard/Dashboard">Home</a></li>
                <li class="breadcrumb-item"><a href="../VendorManager/Index">Vendors</a></li>
                <li class="breadcrumb-item active" aria-current="page">Vendor Details</li>
            </ol><!-- End breadcrumb -->

        </div>
        @if (TempData["Sucessmessage"] != null)
        {
            <p class="alert alert-success alert-dismissible" id="successMessage">
                @TempData["Sucessmessage"]
                <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
            </p>
        }
        @if (TempData["delete"] != null)
        {
            <p class="alert alert-danger alert-dismissible" id="successMessage">
                @TempData["delete"]
                <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
            </p>
        }

        <div role="alert">
            <div class="alert alert-danger" id="Error" style="display: none;margin-top: 20px;">
                <strong><span class="errormessage"></span></strong>
            </div>
            @if (TempData["Error"] != null && TempData["Error"].ToString() != "")
            {
                <div class="alert alert-danger" style="margin-top: 20px;">
                    <strong><span>@TempData["Error"]</span></strong>
                </div>
            }
        </div>
        <!-- End page-header -->

        <div class="row">
            <div class="col-12">
                <div class="card">

                    <div class="card-body">

                        <div class="form-div">

                            <div class="tabs-menu1 ">
                                <!-- Tabs -->
                                <ul class="nav panel-tabs">
                                    <li class=""><a href="#Vendor" class="active" data-toggle="tab">Vendor</a></li>
                                    <li><a href="#bidrequests" data-toggle="tab">Bid Requests</a></li>
                                    <li><a href="#workorders" data-toggle="tab">Work Orders</a></li>
                                </ul>
                            </div>
                            <div class="tab-content">
                                <div class="tab-pane active " id="Vendor">

                                    <div class="row">
                                        <div class="col-12">
                                            <div class="card">
                                                <div class="card-body">
                                                    @Html.HiddenFor(model => model.Vendor.CompanyKey)




                                                    <div class="form-div">

                                                        <div class="row">
                                                            <div class="col-12">
                                                                <div class="card">
                                                                    <div class="card-header">
                                                                        <h3 class="card-title">Company Information</h3>
                                                                        <div class="card-options">
                                                                            <a onclick=" EditPage('company');" class="btn btn-primary ml-auto text-white pull-right" title="Edit"><i class="fa fa-pencil"></i> Edit</a>
                                                                            <a style="margin-left: 10px;" href="#" class="card-options-collapse mr-2" data-toggle="card-collapse"><i class="fe fe-chevron-up"></i></a>
                                                                        </div>
                                                                    </div>
                                                                    <div class="card-body border-top">
                                                                        </h4>
                                                                        <div class="row">
                                                                            <div class="col-md-3">
                                                                                <div class="form-group">
                                                                                    <label class="form-label">Company Name</label>
                                                                                    <p>@Model.Vendor.CompanyName</p>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-md-3">
                                                                                <div class="form-group">
                                                                                    <label class="form-label">Work Phone 1</label>
                                                                                    <p>@Utility.FormatPhoneNumberHelper(Model.Vendor.Work)</p>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-md-3">
                                                                                <div class="form-group">
                                                                                    <label class="form-label">Work Phone 2</label>
                                                                                    <p>@Utility.FormatPhoneNumberHelper(Model.Vendor.Work2)</p>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-md-3">
                                                                                <div class="form-group">
                                                                                    <label class="form-label">Fax</label>
                                                                                    <p>@Utility.FormatPhoneNumberHelper(Model.Vendor.Fax)</p>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-md-4">
                                                                                <div class="form-group">
                                                                                    <label class="form-label">Website</label>
                                                                                    <p>@Model.Vendor.Website</p>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-md-4">
                                                                                <div class="form-group">
                                                                                    <label class="form-label">Address 1</label>
                                                                                    <p>@Model.Vendor.Address</p>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-md-4">
                                                                                <div class="form-group">
                                                                                    <label class="form-label">Address 2</label>
                                                                                    <p>@Model.Vendor.Address2</p>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-md-4">
                                                                                <div class="form-group">
                                                                                    <label class="form-label">City</label>
                                                                                    @Model.Vendor.City
                                                                                </div>
                                                                            </div><!-- end of col -->
                                                                            <div class="col-md-4">
                                                                                <div class="form-group">
                                                                                    <label class="form-label">State</label>
                                                                                    @Model.Vendor.State
                                                                                </div>
                                                                            </div><!-- end of col -->

                                                                            <div class="col-md-4">
                                                                                <div class="form-group">
                                                                                    <label class="form-label">Zip</label>
                                                                                    @Model.Vendor.Zip
                                                                                </div>
                                                                            </div><!-- end of col -->

                                                                        </div><!-- end of row -->

                                                                    </div><!-- card body end -->
                                                                </div><!-- card end -->
                                                            </div><!-- col end -->
                                                        </div><!-- row end -->



                                                        <div class="row">
                                                            <div class="col-12">
                                                                <div class="card">

                                                                    <div class="card-header">
                                                                        <h3 class="card-title">Contact Information</h3>
                                                                        <div class="card-options">
                                                                            <a onclick=" EditPage('contact');" class="btn btn-primary ml-auto text-white pull-right" title="Edit"><i class="fa fa-pencil"></i> Edit</a>
                                                                            <a style="margin-left: 10px;" href="#" class="card-options-collapse mr-2" data-toggle="card-collapse"><i class="fe fe-chevron-up"></i></a>
                                                                        </div>
                                                                    </div>
                                                                    <div class="card-body border-top">
                                                                        <div class="row">
                                                                            <div class="col-md-3">
                                                                                <div class="form-group">
                                                                                    <label class="form-label">Vendor Name</label>
                                                                                    @Model.Resource.FirstName @Model.Resource.LastName
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-md-3">
                                                                                <div class="form-group">
                                                                                    <label class="form-label">Work Phone 1</label>
                                                                                    @Utility.FormatPhoneNumberHelper(Model.Resource.Work)
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-md-3">
                                                                                <div class="form-group">
                                                                                    <label class="form-label">Work Phone 2</label>
                                                                                    @Utility.FormatPhoneNumberHelper(Model.Resource.Work2)
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-md-3">
                                                                                <div class="form-group">
                                                                                    <label class="form-label">Cell Phone</label>
                                                                                    @Utility.FormatPhoneNumberHelper(Model.Resource.CellPhone)
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-md-4">
                                                                                <div class="form-group">
                                                                                    <label class="form-label">Email</label>
                                                                                    @Model.Resource.Email
                                                                                </div>
                                                                            </div>

                                                                        </div><!-- end of row -->

                                                                    </div><!-- card body end -->
                                                                </div><!-- card end -->
                                                            </div><!-- col end -->
                                                        </div><!-- row end -->




                                                        <div class="row">
                                                            <div class="col-12">
                                                                <div class="card">
                                                                    <div class="card-header">
                                                                        <h3 class="card-title">Services</h3>
                                                                        <div class="card-options">
                                                                            @*<a class="btn btn-success ml-auto  pull-right" style="margin-right:2px;color:white;" title="Edit" data-toggle="modal" data-target="#addService"><i class="fa fa-plus"></i></a>*@
                                                                            <a onclick=" EditPage('services');" class="btn btn-primary ml-auto text-white pull-right" title="Edit"><i class="fa fa-pencil"></i> Edit</a>
                                                                            <a style="margin-left: 10px;" href="#" class="card-options-collapse mr-2" data-toggle="card-collapse"><i class="fe fe-chevron-up"></i></a>
                                                                        </div>
                                                                    </div>
                                                                    <div class="card-body border-top">

                                                                        <div class="table-responsive" id="divservc">
                                                                            <table id="dataTableExample" class="table table-striped table-bordered w-100 dataTable no-footer">
                                                                                <thead>
                                                                                    <tr>
                                                                                        <th>Title</th>
                                                                                        <th width="5%"></th>
                                                                                    </tr>
                                                                                </thead>
                                                                                <tbody>
                                                                                    <tr>
                                                                                        <td><span class="ser-fl"></span></td>
                                                                                        <td align="center">
                                                                                            <a title="Delete" onclick="removeser(this);"><i class="fe fe-trash redtxt font18"></i></a>
                                                                                        </td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>

                                                                        </div><!-- end of table responsive -->

                                                                    </div><!-- card body end -->
                                                                </div><!-- card end -->
                                                            </div><!-- col end -->
                                                        </div><!-- row end -->
                                                        @* ----- ----- ----*@





                                                        <div class="row">
                                                            <div class="col-md-12">
                                                                <div class="card">
                                                                    <div class="card-header">
                                                                        <h3 class="card-title">Insurance</h3>
                                                                        <div class="card-options">
                                                                            <a href="/../VendorManager/AddPolicy?CompanyKey=@Model.Vendor.CompanyKey" class="btn btn-primary ml-auto text-white  pull-right" title="Add Insurance"><i class="fa fa-plus"></i> Add</a>

                                                                            @*<a style="margin-left: 10px;" href="#" class="card-options-collapse mr-2" data-toggle="card-collapse"><i class="fe fe-chevron-up"></i></a>*@
                                                                        </div>
                                                                    </div>
                                                                    <div class="card-body border-top">
                                                                        <div id="RawDatas" class="table-responsive">

                                                                            <div class="table-responsive" id="divFileUploader1">
                                                                                @*ViewBag.InsuranceDocs*@
                                                                                @if (ViewBag.InsuranceList != null && ViewBag.InsuranceList.Count > 0)
                                                                                {
                                                                                    <table id="dataTableExample" class="table table-striped table-bordered w-100 dataTable no-footer">
                                                                                        <thead>
                                                                                            <tr>

                                                                                                <th width="30%" style="cursor: pointer;">
                                                                                                    Policy Number
                                                                                                </th>
                                                                                                <th width="20%">Amount</th>
                                                                                                <th width="20%">EXPIRATION</th>
                                                                                                <th width="10%"></th>
                                                                                            </tr>
                                                                                        </thead>
                                                                                        <tbody>

                                                                                            @for (int doc = 0; doc < ViewBag.InsuranceList.Count; doc++)
                                                                                            {

                                                                                                <tr>
                                                                                                    <td><span class="PolicyNumber">@ViewBag.InsuranceList[doc].PolicyNumber</span></td>

                                                                                                    <td><span class="InsuranceAmount">@Utility.FormatNumberHelper(ViewBag.InsuranceList[doc].InsuranceAmount,true)</span></td>
                                                                                                    <td><span class="EndDate"></span>@Convert.ToDateTime(ViewBag.InsuranceList[doc].EndDate).ToString("MM/dd/yyyy")</td>
                                                                                                    @*<td>
                                @{ string name = ViewBag.InsuranceDocs[doc].Document.FileName;}


                                @Html.ActionLink(" " + name, "DownloadFile", "VendorManager", new { DocumentKey = ViewBag.InsuranceDocs[doc].Document.DocumentKey, CompanyKey = Model.Vendor.CompanyKey, InsuranceKey = ViewBag.InsuranceDocs[doc].Insurance.InsuranceKey }, new { @class = "ion-link link text-azure" })
                            </td>*@


                                                                                                    <td class="text-center"><a id="viewdata1" title="View Details" onclick="toggleModal('@ViewBag.InsuranceList[doc].InsuranceKey')"><i class="fe fe-eye font18" style="cursor:pointer;"></i></a></td>

                                                                                                </tr>
                                                                                            }
                                                                                        </tbody>
                                                                                    </table>
                                                                                }
                                                                            </div><!-- end of table responsive -->
                                                                        </div><!-- end of col -->
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="row">
                                                            <div class="col-lg-12 col-xl-12 col-md-12 col-sm-12">
                                                                <div class="card">
                                                                    <div class="card-body">
                                                                        <div class="row">
                                                                            <div class="col-lg-3 col-md-12">
                                                                                <div class="form-group">
                                                                                    <label class="form-label">Radius </label>

                                                                                    @Html.DropDownList("Radius", new SelectList(ViewBag.lstRadius, "Value", "Text"), new { @tabindex = "6", @class = "form-control", @onchange = "OnRadiusChanges(this)", @disabled = "disabled" })
                                                                                </div>
                                                                                <div class="form-group">
                                                                                    <label class="form-label">Address</label>
                                                                                    <p id="vServiceAddress"></p>
                                                                                    <p>@Html.DisplayFor(Model => Model.ServiceAddress, new { @class = "form-control" })</p>

                                                                                </div>
                                                                            </div><!-- end of col -->
                                                                            <div class="col-lg-9 col-md-12">
                                                                                <div class="form-group mapIframe">
                                                                                    <label class="form-label">Map</label>
                                                                                    <div id="map" style="width:100%;height:300px;"></div>
                                                                                    @*<iframe id="srcid" width="100%" height="300" frameborder="0" style="border:0;" allowfullscreen="" aria-hidden="false" tabindex="0"></iframe>*@
                                                                                    @*<iframe id="srcid" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d93321.45784906122!2d-76.2093204565947!3d43.035212545342986!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89d9f39bbf979a0d%3A0xd50ce2d7ad9545!2sSyracuse%2C%20NY%2C%20USA!5e0!3m2!1sen!2sin!4v1583905479861!5m2!1sen!2sin&callback=initMap" width="100%" height="300" frameborder="0" style="border:0;" allowfullscreen="" aria-hidden="false" tabindex="0"></iframe>*@
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>


                                                        @if (Model.UserModel != null)
                                                        {
                                                            <div class="row">
                                                                <div class="col-md-12 grid-margin stretch-card">
                                                                    <div class="card">
                                                                        <div class="card-header">
                                                                            <h3 class="card-title">User Account</h3>
                                                                            <div class="card-options">
                                                                                @*<a class="btn btn btn-primary pull-right" title="Edit"><i class="fa fa-pencil"></i> Edit</a>*@
                                                                                <a onclick="EditPage('userAccount');" class="btn btn-primary text-white ml-auto  pull-right" title="Edit"><i class="fa fa-pencil"></i> Edit</a>

                                                                                <a style="margin-left: 10px;" href="#" class="card-options-collapse mr-2" data-toggle="card-collapse"><i class="fe fe-chevron-up"></i></a>
                                                                            </div>
                                                                        </div>
                                                                        <div class="card-body border-top">

                                                                            <div class="row">
                                                                                <div class="col-md-4">
                                                                                    <div class="form-group">
                                                                                        <label class="form-label">Username</label>

                                                                                        <p>@Model.Resource.Email</p>
                                                                                    </div>

                                                                                </div>
                                                                                <div class="col-md-4">
                                                                                    <div class="form-group">
                                                                                        <label class="form-label">New Password</label>
                                                                                        <p>
                                                                                            @{ char[] str = Model.UserModel.Password.ToCharArray();
                                                                                                <span>
                                                                                                    @foreach (var ch in str)
                                                                                                    {
                                                                                                        <i>*</i>
                                                                                                    }
                                                                                                </span>
                                                                                            }
                                                                                        </p>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-md-4">
                                                                                    <div class="form-group">
                                                                                        <label class="form-label">Card Number</label>
                                                                                        <p>
                                                                                            @Model.Resource.MaskedCCNumber


                                                                                        </p>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div><!-- end of row -->
                                                        }
                                                        @* ----- ----- ----*@
                                                        @*
            <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Insurance</h3>
                        <div class="card-options">
                            <a onclick=" EditPage();" class="btn btn-primary ml-auto text-white pull-right" title="Edit"><i class="fa fa-pencil"></i> Edit</a>
                            <a style="margin-left: 10px;" href="#" class="card-options-collapse mr-2" data-toggle="card-collapse"><i class="fe fe-chevron-up"></i></a>
                        </div>
                    </div>
                    <div class="card-body border-top">
                        <div id="RawDatas" class="table-responsive">
                            <table id="dataTableExample" class="table table-striped table-bordered text-nowrap w-100 dataTable no-footer">
                                <thead>
                                    <tr>

                                        <th width="30%" ('PolicyNumber') style="cursor: pointer;">

                                            Policy Number
                                        </th>
                                        <th width="30%" ('InsuranceAmount') style="cursor: pointer;">

                                            Amount
                                        </th>
                                        <th width="30%" ('StartDate') style="cursor: pointer;">

                                            Expiration
                                        </th>
                                        <th width="15%">&nbsp;</th>
                                    </tr>

                                </thead>
                                <tbody>
                                    <tr>

                                        <td><span class="policynumber"></span></td>
                                        <td><span class="insuranceamount"></span></td>
                                        <td><span class="startdate"></span></td>

                                        <td align="center"><a id="viewdata" class="badge badge-primary pull-right" data-toggle="modal" data-target="#viewinsurance"><i class="fa fa-certificate"></i> View Insurance</a></td>

                                    </tr>



                                </tbody>
                            </table>
                        </div>

                    </div><!-- card body end -->

                    <div class="pagination" style="display:none;">

                        <input type="hidden" id="HdnPageIndex" value="1" />
                        <input type="hidden" id="PageSize" value="20" />
                        <input type="hidden" id="TotalPageRecord" value='0' />
                    </div>
                </div><!-- card end -->
            </div><!-- col end -->
        </div><!-- row end -->
                                                        *@
                                                    </div><!-- end of form-div  -->

                                                </div><!--end of card body -->
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Message Modal -->
                                    <div class="modal fade" id="AddPolicy" tabindex="-1" role="dialog" aria-labelledby="uploadmodalLabel" aria-hidden="true">
                                        <div class="myModal" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="uploadmodalLabel">Add Policy</h5>
                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                        <span aria-hidden="true">×</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">

                                                </div>
                                            </div>
                                        </div>
                                    </div>




                                    <div class="modal fade" id="addService" tabindex="-1" role="dialog" aria-labelledby="uploadmodalLabel" aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="uploadmodalLabel">Add Service</h5>
                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                        <span aria-hidden="true">×</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    @using (Html.BeginForm("VendorManagerAddService", "VendorManager", new { CompanyKey = Model.Vendor.CompanyKey }, FormMethod.Post))
                                                    {
                                                        <div class="row">
                                                            <div class="col-md-8">
                                                                <div class="form-group">
                                                                    <label class="form-label">Select Service</label>
                                                                    @Html.DropDownList("VendorServce", new SelectList(ViewBag.lstservice, "Value", "Text"), new { @class = "form-control" })
                                                                </div>
                                                                <div class="form-group">
                                                                    <input type="submit" id="btnSubmit1" name="btnAddService" value="Add Service" class="btn btn-primary" />
                                                                </div>
                                                            </div>
                                                        </div>
                                                    }
                                                </div>
                                            </div>
                                        </div>
                                    </div>



                                    <div class="modal fade" id="viewinsurance" tabindex="-1" role="dialog" aria-labelledby="uploadmodalLabel" aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="uploadmodalLabel">View Insurance</h5>
                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                        <span aria-hidden="true">×</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <form>
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <label class="form-label">Policy Number</label>
                                                                    <span id="policynumber"></span>
                                                                    @*@Model.Vendor.PolicyNumber*@
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <label class="form-label">Amount</label>
                                                                    <span id="amount"></span>
                                                                    @*@Model.Vendor.InsuranceAmount*@
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <label class="form-label">Start Date</label>
                                                                    <span id="startdate"></span>
                                                                    @*@Model.Vendor.StartDate*@
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <label class="form-label">End Date</label>
                                                                    <span id="enddate"></span>
                                                                    @*@Model.Vendor.EndDate*@
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <label class="form-label">Renewal Date</label>
                                                                    <span id="renewaldate"></span>
                                                                    @*@Model.Vendor.RenewalDate*@
                                                                </div>
                                                            </div>
                                                            <div class="card-body col-md-12"> @*border-top*@
                                                                <div id="RawDatas1" class="table-responsive">

                                                                    <div class="table-responsive" id="divFileUploader1">
                                                                        @*@if (ViewBag.InsuranceDocs != null && ViewBag.InsuranceDocs.Count > 0)*@
                                                                        @* { *@
                                                                            <table id="dataTableExample" class="table table-striped table-bordered w-100 dataTable no-footer">
                                                                                <thead>
                                                                                    <tr>

                                                                                        <th width="30%" style="cursor: pointer;">
                                                                                            Document
                                                                                        </th>
                                                                                    </tr>
                                                                                </thead>
                                                                                <tbody>
                                                                                    <tr>
                                                                                        <td><a id="alink"><span id="atext"></span></a></td>
                                                                                    </tr>
                                                                                    @*@if (ViewBag.InsuranceDocs[0].Document.DocumentKey > 0)
                                                                                    {*@
                                                                                        @*for (int doc = 0; doc < ViewBag.InsuranceDocs.Count; doc++)
                                                                                        {*@

                                                                                        @*<tr>

                                                                                            <td>*@
                                                                                                @*@{ string name = ViewBag.InsuranceDocs[doc].Document.FileName;}*@


                                                                                                @*@Html.ActionLink(" " + name, "DownloadFile", "VendorManager", new { DocumentKey = ViewBag.InsuranceDocs[doc].Document.DocumentKey, CompanyKey = Model.Vendor.CompanyKey, InsuranceKey = ViewBag.InsuranceDocs[doc].Insurance.InsuranceKey }, new { @class = "link" })*@
                                                                                            @*</td>*@


                                                                                            @*<td class="text-center"><a id="viewdata1" onclick="toggleModal('@ViewBag.InsuranceDocs[doc].Insurance.InsuranceKey')"><i class="fe fe-eye font18"></i></a></td>*@

                                                                                        @*</tr>*@
                                                                                                        @*}
                                                                                                    }*@
                                                                                </tbody>
                                                                            </table>
                                                                        @* } *@
                                                                    </div><!-- end of table responsive -->
                                                                </div><!-- end of col -->
                                                            </div>
                                                        </div>
                                                        <hr />


                                                    </form>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                    <div class="modal fade" id="addinsurance" tabindex="-1" role="dialog" aria-labelledby="uploadmodalLabel" aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="uploadmodalLabel">Add Insurance</h5>
                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                        <span aria-hidden="true">×</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    @using (Html.BeginForm("AddInsuranceWithDoc", "VendorManager", new { CompanyKey = Model.Vendor.CompanyKey }, FormMethod.Post, new { enctype = "multipart/form-data" }))
                                                    {
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <label class="form-label">Policy Number</label>
                                                                    @Html.TextBoxFor(model => model.Insurance.PolicyNumber, new { @class = "form-control", PlaceHolder = "Policy Number" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <label class="form-label">Insurance Amount</label>
                                                                    @Html.TextBoxFor(model => model.Insurance.InsuranceAmount, new { @class = "form-control", PlaceHolder = "Insurance Amount" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <label class="form-label">Agent Name</label>
                                                                    @Html.TextBoxFor(model => model.Insurance.AgentName, new { @class = "form-control", PlaceHolder = "Agent Name" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <label class="form-label">Start Date</label>
                                                                    @Html.TextBoxFor(model => model.Insurance.StartDate, new { @class = "form-control", PlaceHolder = "ex: 01/01/1990" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <label class="form-label">End Date</label>
                                                                    @Html.TextBoxFor(model => model.Insurance.EndDate, new { @class = "form-control", PlaceHolder = "ex: 01/01/1990" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <label class="form-label">Renewal Date</label>
                                                                    @Html.TextBoxFor(model => model.Insurance.RenewalDate, new { @class = "form-control", PlaceHolder = "ex: 01/01/1990" })
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <hr />


                                                        <div class="row">

                                                            <div class="col-md-8">
                                                                <div class="form-group">
                                                                    <input type="file" name="files" id="files" class="form-control" />
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4 center no-padding-bottom">
                                                                <div class="form-group">
                                                                    @Html.TextBox("btnSubmit", "Add Insurance", new { @class = "btn btn-primary", type = "submit", style = "padding:8px;" })
                                                                </div>
                                                            </div>
                                                        </div><!-- end of row -->
                                                    }
                                                </div>

                                            </div>
                                        </div>
                                    </div><!-- end of modal-->
                                </div>

                                <div class="tab-pane " id="bidrequests">

                                    <div class="row">
                                        <div class="col-12">
                                            <div class="card">

                                                <div class="card-body">

                                                    <div class="table-responsive">
                                                        <table id="bidRequestTable" class="table table-bordered text-nowrap w-100 dataTable no-footer">
                                                            <thead>
                                                                <tr>
                                                                    <th>Title</th>
                                                                    <th>Property Name</th>
                                                                    <th>Bid Due Date</th>
                                                                    <th>Bid Request Status</th>
                                                                    <th align="center" class="text-center">Action</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr class="highlighttr">
                                                                    <td class="bidtitle"></td>
                                                                    <td class="bidproperty"></td>
                                                                    <td class="bidduedate"></td>
                                                                    <td class="bidreqstatus"></td>
                                                                    <td align="center" class="text-center">
                                                                        <a class="alinkbidview text-primary">
                                                                            <span class="fa fa-eye font18"></span>
                                                                        </a>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>

                                                </div><!-- end of card body -->
                                            </div><!-- end of card -->
                                        </div><!-- end of col -->
                                        <div class="dataTables_paginate paging_simple_numbers" id="pagin">
                                            <ul class="pagination"></ul>

                                        </div>
                                    </div><!-- end of row -->

                                    <div class="pagination" style="display:none;">
                                        <input type="hidden" id="HdnSortValue" value="order by Bidrequest.title asc" />
                                        <input type="hidden" id="HdnPageIndex" value="1" />
                                        <input type="hidden" id="PageSize" value="10" />
                                        <input type="hidden" id="Namehdn" value="asc" />
                                        <input type="hidden" id="Workhdn" value="asc" />
                                        <input type="hidden" id="Titlehdn" value="asc" />
                                        <input type="hidden" id="TotalPageRecord" value='0' />
                                    </div>


                                </div><!-- end of tab -->
                                <div class="tab-pane " id="workorders">

                                    <div class="row">
                                        <div class="col-12">
                                            <div class="card">

                                                <div class="card-body">

                                                    <div class="table-responsive">
                                                        <table id="workOrderTable" class="table table-bordered text-nowrap w-100 dataTable no-footer">
                                                            <thead>
                                                                <tr>
                                                                    <th>Title</th>
                                                                    <th>Property Name</th>
                                                                    <th>Work Order Start Date</th>
                                                                    <th>Work Order Due Date</th>
                                                                    <th>Work Order Status</th>
                                                                    <th align="center" class="text-center">Action</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr class="highlighttr">
                                                                    <td class="worktitle"></td>
                                                                    <td class="workproperty"></td>
                                                                    <td class="workstartdate"></td>
                                                                    <td class="workduedate"></td>
                                                                    <td class="workstatus"></td>
                                                                    <td align="center" class="text-center">
                                                                        <a class="worklink text-primary">
                                                                            <span class="fa fa-eye font18"></span>
                                                                        </a>
                                                                    </td>
                                                                </tr>

                                                            </tbody>
                                                        </table>
                                                    </div>

                                                    <div class="dataTables_paginate paging_simple_numbers" id="paginW">
                                                        <ul class="paginationW"></ul>

                                                    </div>
                                                </div><!-- end of card body -->
                                            </div><!-- end of card -->
                                        </div><!-- end of col -->
                                    </div><!-- end of row -->
                                    <div class="pagination" style="display:none;">
                                        <input type="hidden" id="HdnSortValueW" value="order by Bidrequest.title asc" />
                                        <input type="hidden" id="HdnPageIndexW" value="1" />
                                        <input type="hidden" id="PageSizeW" value="10" />
                                        <input type="hidden" id="NamehdnW" value="asc" />
                                        <input type="hidden" id="WorkhdnW" value="asc" />
                                        <input type="hidden" id="TitlehdnW" value="asc" />
                                        <input type="hidden" id="TotalPageRecordW" value='0' />
                                    </div>
                                </div><!-- end of tab -->
                            </div><!-- end of tab content -->
                        </div>

                    </div>
                </div>
                <!--footer-->
                <footer class="footer">
                    <div class="container">
                        <div class="row align-items-center flex-row-reverse">
                            <div class="col-lg-12 col-sm-12   text-center">
                                Copyright © 2020 Association Bids. All rights reserved.
                            </div>
                        </div>
                    </div>
                </footer><!-- End Footer-->
            </div><!--End side app-->

        </div><!-- End app-content-->
    </div>
</div>
<script>

    $(document).ready(function () {
        //$("#Vend1").closest('li').addClass('active');
        //$("#Inv4").addClass('active');
        SetActiveMenu($("#Vend1"),false);
            bindservice();
            //bindDocument();
            //insurancetableFill();
            bindBidRequest();
           bindWorkOrder();
           Fillvalueview();
            $("#ddlload").hide();
            $(".advance_search").click(function () {
                $("#advancesearch3").toggle(500);
            });
            $(".overlayclose").click(function () {
                $("#advancesearch3").hide();
            });
            $('.loader-wrapper').show();
        $.get('/VendorManager/IndexinsurancePaging', { PageSize: 0, PageIndex: 1, Search: '', Sort: 'order by InsuranceKey' }, function (response) {
            $("#RawDatas table tbody tr:eq(0)").hide();
            $(".loader-wrapper").hide();
        });

        });


        @*function insurancetableFill() {
            debugger;
            $.ajax({

                url: '@Url.Action("IndexinsurancePaging", "VendorManager")',
                cache: false,
                data:
                {
                    CompanyKey: $('#CompanyKey').val()
                },
                success: function (response) {

                    if (parseInt(response.length) > 0) {

                        var curRecords = 0;
                        var TotalRecs = 0;
                        debugger;
                        curRecords = parseInt(($('#HdnPageIndex').val()) * parseInt($('#PageSize').val()));
                        curRecords = curRecords - ($('#PageSize').val() - parseInt(response.length));
                        TotalRecs = parseInt(response[0].TotalRecords);
                        $('.spnOfRecs').text(curRecords);
                        $('.spnTotalRecs').text(TotalRecs);
                        if (curRecords === 0 || curRecords === TotalRecs) {
                            $("#ddlload").hide();
                        }
                        else {
                            $("#ddlload").show();
                        }
                    } else {
                        $("#ddlload").hide();
                    }
                    $("#RawDatas table tbody tr:not(:first)").remove();
                    $("#RawDatas table tbody tr:eq(0)").show();
                    for (var i = 0; i < response.length; i++) {
                        var table = $("#RawDatas table tbody tr:eq(0)").clone(true);
                        $(".policynumber", table).html(response[i].FileName);
                        //$(".insuranceamount", table).html(response[i].InsuranceAmount);
                        //$(".startdate", table).html(response[i].StartDate);
                        $("#viewdata", table).attr('href', '/VendorManager/VendorView?CompanyKey=' + response[i].CompanyKey);

                        $("#RawDatas table").append(table);
                    }
                    $("#RawDatas table tbody tr:eq(0)").hide();
                    $("#loading1").hide();
                }
            });
        }*@

        function EditPage() {
            var a = $("#CompanyKey").val();

            window.location.href = 'VendorEdit?CompanyKey=' + $("#CompanyKey").val();

        }
        function EditPage(formname) {
            var a = $("#Vendor_CompanyKey").val();
            window.location.href = 'VendorEdit?CompanyKey=' + a + "&param=" + formname;

        }

       function Fillvalueview() {
        var valaddress = '@ViewBag.address';
         var valaddress2 = '@ViewBag.address2';
         var valCity = '@ViewBag.City';
        var valZip = '@ViewBag.Zip';

           debugger;
        $('#ServiceAddress').val(valaddress + ' ' + valaddress2);
        $('#vServiceAddress').html(valaddress + ' ' + valaddress2);
        $('#vserviceaddressc').html(valaddress + ' ' + valaddress2);
        $('#vRadius').html($('#RadiusRadius option:selected').text());
        $('#vCompanyName').html($('#CompanyName').val());
        $('#vLegalName').html($('#LegalName').val());
        $('#vTaxID').html($('#TaxID').val());
        if ($('#Address2').val() !== "") {
            $('#vServiceAddress').html(valaddress + ' ' + valaddress2 + ', ' + valCity + ', ' + $('#State option:selected').text() + ' ' + valZip);
            $('#vserviceaddressc').html(valaddress + ' ' + valaddress2 + ', ' + valCity + ', ' + $('#State option:selected').text() + ' ' + valZip);
        }
        else {

            $('#vServiceAddress').html(valaddress + ' ' + valaddress2 + ', ' + valCity + ', ' + $('#State option:selected').text() + ' ' + valZip);
            $('#vserviceaddressc').html(valaddress + ' ' + valaddress2 + ', ' + valCity + ', ' + $('#State option:selected').text() + ' ' + valZip);
        }
        $('#vAddress').html(valaddress);
        $('#vAddress2').html(valaddress2);
        $('#vCity').html(valCity);
        $('#vStateKey').html($('#StateKey').val());
        $('#vState').html($('#State').val());
        $('#vZip').html($('#Zip').val());
        $('#vWork').html($('#Work').val());
        $('#vWork2').html($('#Work2').val());
        $('#vWebsite').html($('#Website').val());
        $('#vFax').html($('#Fax').val());
        $('#vNameOfCard').html($('#NameOfCard').val());
        $('#vfirstname').html($('#FirstName').val());
        $('#vlastname').html($('#LastName').val());
        $('#vEmail').html($('#EmailId').val());


        var policyno = $("#PolicyNumber").val();
        var files = $("#Insurancefiles")[0].files;
        //if (files.length > 0 && policyno != '')
        {
            $("#policyno").html(policyno);
            $("#insuranceamount").html($("#InsuranceAmount").val());
            $("#startdate").html($("#StartDate").val().split(" ")[0] == '1/1/0001' ? '' : $("#StartDate").val());
            $("#enddate").html($("#EndDate").val().split(" ")[0] == '1/1/0001' ? '' : $("#EndDate").val());
            $("#renewaldate").html($("#RenewalDate").val().split(" ")[0] == '1/1/0001' ? '' : $("#RenewalDate").val());
            var docnames = '';
            for (var i = 0; i < files.length; i++) {
                docnames += '<p>' + files[i].name + '</p>';
            }
            $("#docname").html(docnames);
            if (policyno != '') {
                $("#insDetails").show();
            }
            else {
                $("#insDetails").hide();
            }
        }

        if ($('#CardNumber').val() !== "") {
            const id = $('#CardNumber').val();
            var fourlastchar = id.substr(id.length - 5);
            $('#vCardNumber').html('XXXX XXXX XXXX ' + fourlastchar);
        }

        $('#vValidTillMM').html($('#ValidTillMM').val());
        $('#vValidTillYY').html($('#ValidTillYY').val());
        $('#vFullValidTill').html($('#ValidTillMM').val() + '/' + $('#ValidTillYY').val());
        $('#vCVV').html($('#CVV').val());
        $('#sucesssave').hide();
        $('#errrorssave').hide();

    }



        function removeser(me) {
            debugger;
            var m = $(me).parent("td").parent("tr").find('.ser-fl').text();

            var a = $("#Vendor_CompanyKey").val();
            var b = $(me).parent("td").parent("tr").find('.ser-fl').text();
            var c = $(me).parent("td").parent("tr").find('input[name = "vsk"]').val();
            var r = confirm("Are you sure to remove service: " + b + "?");
            if (r) {
                //var formdata = new FormData();
                //formdata.append("CompanyKey", a);
                //formdata.append("VendorServiceKey", c);
                //window.location.href = "DeleteAsync?CompanyKey=" + a + "&VendorServiceKey=" + c;
                $.ajax({
                    type: 'post',
                    url: '@Url.Action("DeleteAsync", "VendorManager")',
                    cache: false,
                    data: {
                        CompanyKey: a,
                        VendorServiceKey: c
                    },
                    success: function (response) {
                        bindservice();
                    },
                    error: function () {

                    }
                });
            }
        }


        $("#btnadd").click(function () {

            $("#vendordiv table tbody tr:eq(0)").show();
            var vendor = $("#ServiceTitle1 option:selected").map(function () {
                var cln = $("#vendordiv table tbody tr:eq(0)").clone(true);
                $(".venspan", cln).html($(this).text());
                $("#vendordiv table").append(cln);

            }).get();

            $("#vendordiv table tbody tr:eq(0)").hide();

            if ($('#ServiceTitle1_chosen').find('.chosen-choices').find('.search-choice').length == 0) {
                $('.errormessage').html('Please select vendor.');
                $('#Errormanager').show();
                return false;
            }
            else {
                var vendor = $("#Choosen option:selected").map(function () {
                    return $(this).val();
                }).get().join(',');
                $('#ServiceKey').val(vendor);
            }

        });



    function OnRadiusChanges() {

        setTimeout(function () {

            initMap();
        }, 1000);
    }
    function initMap() {

        map = new google.maps.Map(document.getElementById('map'), { zoom: 10 });
        geocoder = new google.maps.Geocoder();
        codeAddress(geocoder, map);

    }

    function codeAddress(geocoder, map) {
        geocoder.geocode({ 'address': $("#vServiceAddress").html() }, function (results, status) {

            if (status === 'OK') {
                var str = $("#Radius option:selected").text().split(" ");
                if (str[0] === 'Please') {
                    str = '0';
                }

                var marker = new google.maps.Marker({
                    map: map,
                    position: results[0].geometry.location
                });
                var circle = new google.maps.Circle({
                    map: map,
                    radius: str[0] * 1609.344,
                    fillOpacity: 0.25,
                    fillColor: '#AA0000'
                });
                circle.bindTo('center', marker, 'position');
                map.setCenter(results[0].geometry.location);
            }

        });
    }


    function codeAddressview(geocoder, map1) {

        geocoder.geocode({ 'address': $("#vServiceAddress").html() }, function (results, status) {

            if (status === 'OK') {
                var str = $("#Radius option:selected").text().split(" ");
                if (str[0] === 'Please') {
                    str = '0';
                }

                var marker = new google.maps.Marker({
                    map: map1,
                    position: results[0].geometry.location
                });
                var circle = new google.maps.Circle({
                    map: map1,
                    radius: str[0] * 1609.344,
                    fillOpacity: 0.25,
                    fillColor: '#AA0000'
                });
                circle.bindTo('center', marker, 'position');
                map1.setCenter(results[0].geometry.location);
            }

        });
    }


    function toggleModal(insuranceKey) {
        $("#RawDatas1 table tbody tr:eq(0)").hide();
            var companyKey = $('#Vendor_CompanyKey').val();
            $.ajax({
                url: '@Url.Action("GetInsuranceDetails", "VendorManager")',
                cache: false,
                data:
                {
                    CompanyKey: companyKey,
                    InsuranceKey: insuranceKey
                },
                success: function (response) {
                    debugger;
                    if (response != null && response.length > 0) {
                        $("#policynumber").text(response[0].Insurance.PolicyNumber);
                        $("#amount").text("$"+formatNumber(response[0].Insurance.InsuranceAmount,true));
                        $("#startdate").text(response[0].Insurance.StartDates);
                        $("#enddate").text(response[0].Insurance.EndDates);
                        $("#renewaldate").text(response[0].Insurance.RenewalDates);
                        $("#viewinsurance").modal('toggle');
                    }
                    debugger;
                    $("#RawDatas1 table tbody tr:not(:first)").remove();
                    //$("#RawDatas1 table tbody tr:eq(0)").show();
                    if (response.length > 0 && response[0].Document.DocumentKey > 0) {
                        for (var i = 0; i < response.length; i++) {
                            var cln = $("#RawDatas1 table tbody tr:eq(0)").clone(true);
                            $("#atext", cln).html(response[i].Document.FileName);
                            $("#alink", cln).attr('href', "../Document/Insurance/" + response[i].Insurance.InsuranceKey + response[i].Document.FileName);

                      
                            $("#RawDatas1 table tbody").append(cln);
                            cln.show();
                        }
                    }
                    //$("#RawDatas1 table tbody tr:eq(0)").hide();
                }
            });
        }
        function getDate(datestring) {

            var milli = datestring.replace(/\/Date\((-?\d+)\)\//, '$1');
            var date1 = new Date(parseInt(milli)).toLocaleDateString();
            var mon = date1.split('/')[0];
            var day = date1.split('/')[1];
            var year = date1.split('/')[2];
            if (mon.length == 1)
                mon = "0" + mon;
            if (day.length == 1)
                day = "0" + day;
            return mon + "/" + day + "/" + year;
        }
        @*function bindDocument() {
            $.ajax({
                url: '@Url.Action("bindDocument", "VendorManager")',
                cache: false,
                data:
                {
                    CompanyKey: $('#Vendor_CompanyKey').val()
                },
                success: function (response) {
                    debugger;
                    $("#divFileUploader1 table tbody tr:not(:first)").remove();
                    $("#divFileUploader1 table tbody tr:eq(0)").show();
                    for (var i = 0; i < response.length; i++) {
                        var cln = $("#divFileUploader1 table tbody tr:eq(0)").clone(true);
                        $(".upd-fl", cln).html(response[i].Document.FileName);
                        $("#divFileUploader1 table").append(cln);
                    }
                    $("#divFileUploader1 table tbody tr:eq(0)").hide();
                }
            });
        }*@





     @*function insurancetableFill()
    {
        debugger;
        $.ajax({

            url: '@Url.Action("IndexinsurancePaging", "VendorManager")',
            cache: false,
             data:
              {
                 CompanyKey: $('#CompanyKey').val()
              },
            success: function (response)
            {

                if (parseInt(response.length) > 0) {
                    if (response.do)
                    {

                    }
                    var curRecords = 0;
                    var TotalRecs = 0;
                    debugger;
                    curRecords = parseInt(($('#HdnPageIndex').val()) * parseInt($('#PageSize').val()));
                    curRecords = curRecords - ($('#PageSize').val() - parseInt(response.length));
                    TotalRecs = parseInt(response[0].TotalRecords);
                    $('.spnOfRecs').text(curRecords);
                    $('.spnTotalRecs').text(TotalRecs);
                    if (curRecords === 0 || curRecords === TotalRecs) {
                        $("#ddlload").hide();
                    }
                    else {
                        $("#ddlload").show();
                    }
                } else {
                    $("#ddlload").hide();
                }

                $("#RawDatas table tbody tr:not(:first)").remove();
                $("#RawDatas table tbody tr:eq(0)").show();
                for (var i = 0; i < response.length; i++) {

                    var table = $("#RawDatas table tbody tr:eq(0)").clone(true);
                    $(".policynumber", table).html(response[i].PolicyNumber);
                    //$(".insuranceamount", table).html(response[i].InsuranceAmount);
                    //$(".startdate", table).html(response[i].StartDate);
                    $("#viewdata", table).attr('href', '/VendorManager/VendorView?CompanyKey=' + response[i].CompanyKey);

                    $("#RawDatas table").append(table);
                }
                $("#RawDatas table tbody tr:eq(0)").hide();
                $("#loading1").hide();
            }
        });
    }*@


    function toggleModal(insuranceKey) {
        $("#RawDatas1 table tbody tr:eq(0)").hide();
        var companyKey = $('#Vendor_CompanyKey').val();
        $.ajax({
            url: '@Url.Action("GetInsuranceDetails", "VendorManager")',
            cache: false,
            data:
            {
                CompanyKey: companyKey,
                InsuranceKey: insuranceKey
            },
            success: function (response) {
                debugger;

                if (response != null && response.length > 0) {

                    $("#policynumber").text(response[0].Insurance.PolicyNumber);
                    $("#amount").text("$" + formatNumber(response[0].Insurance.InsuranceAmount,true));
                    $("#startdate").text(response[0].Insurance.StartDates);
                    $("#enddate").text(response[0].Insurance.EndDates);
                    $("#renewaldate").text(response[0].Insurance.RenewalDates);
                    $("#viewinsurance").modal('toggle');
                    debugger;
                    $("#RawDatas1 table tbody tr:not(:first)").remove();
                    if (response.length > 0 && response[0].Document.DocumentKey > 0) {
                        //$("#RawDatas1 table tbody tr:eq(0)").show();
                        for (var i = 0; i < response.length; i++) {
                            var cln = $("#RawDatas1 table tbody tr:eq(0)").clone(true);
                            $("#atext", cln).html(response[i].Document.FileName);

                            //$("#alink", cln).attr('href', "../Document/Insurance/" + companyKey + "/" + response[i].Insurance.InsuranceKey+"/"+ response[i].Document.FileName);

                            $("#alink", cln).attr('href', "../Document/Insurance/"+response[i].Insurance.InsuranceKey+ response[i].Document.FileName);

                        
                            //$(".InsuranceAmount", cln).html(formatNumber(response[0].Insurance.InsuranceAmount,true));
                            //$(".PolicyNumber", cln).html(response[0].Insurance.PolicyNumber);
                            //$(".EndDate", cln).html(getDate(response[0].Insurance.EndDate));
                            $("#RawDatas1 table tbody").append(cln);
                            cln.show();
                        }
                    }
                    //$("#RawDatas1 table tbody tr:eq(0)").hide();
                    if (response[0].Document.FileName == "") {
                        $("#RawDatas1").hide();
                    } else {
                        $("#RawDatas1").show();
                    }
                }
            }
        });
    }
     @*function bindDocument()
     {
         debugger;
         $.ajax({
            url: '@Url.Action("bindDocument", "VendorManager")',
            cache: false,
             data:
              {
                 CompanyKey: $('#Vendor_CompanyKey').val()
              },
            success: function (response)
            {

                debugger;
                $("#RawDatas table tbody tr:not(:first)").remove();
               // $("#RawDatas table tbody tr:eq(0)").show();
                for (var i = 0; i < response.length; i++)
                {
                    var cln = $("#RawDatas table tbody tr:eq(0)").clone(true);
                    $(".upd-fl", cln).html(response[0].Document.FileName);
                    //$(".InsuranceAmount", cln).html(formatNumber(response[0].Insurance.InsuranceAmount,true));
                    //$(".PolicyNumber", cln).html(response[0].Insurance.PolicyNumber);
                    //$(".EndDate", cln).html(getDate(response[0].Insurance.EndDate));
                    $("#RawDatas table").append(cln);
                }
                $("#RawDatas table tbody tr:eq(0)").hide();
            }
        });
    }*@
        function bindservice() {
            debugger;
            $.ajax({

                url: '@Url.Action("bindservice", "VendorManager")',
                cache: false,
                data:
                {
                    CompanyKey: $('#Vendor_CompanyKey').val()
                },
                success: function (response) {
                    debugger;
                    $("#divservc table tbody tr:not(:first)").remove();
                    $("#divservc table tbody tr:eq(0)").show();
                    for (var i = 0; i < response.length; i++) {
                        var cln = $("#divservc table tbody tr:eq(0)").clone(true);
                        $(".ser-fl", cln).html(response[i].Title);
                        $(cln).append("<input type='hidden' name='vsk' value='" + response[i].VendorServiceKey + "'/>");
                        $("#divservc table").append(cln);
                    }
                    $("#divservc table tbody tr:eq(0)").hide();
                }
            });
        }

        function bindBidRequest() {
            debugger;
            $.ajax({

                url: '@Url.Action("BindBidRequest", "VendorManager")',
                cache: false,
                data:
                {
                    CompanyKey: $('#Vendor_CompanyKey').val(),
                    pageSize: $('#PageSize').val(),
                    index: $('#HdnPageIndex').val(),
                    Search: "",
                    sort: $("#HdnSortValue").val()
                },
                success: function (response) {
                    debugger;
                    $("#bidRequestTable tbody tr:not(:first)").remove();
                    $("#bidRequestTable tbody tr:eq(0)").show();
                    for (var i = 0; i < response.length; i++) {
                        var cln = $("#bidRequestTable tbody tr:eq(0)").clone(true);
                        $(".bidtitle", cln).html(response[i].Title);
                        $(".bidproperty", cln).html(response[i].Property);
                        $(".bidduedate", cln).html(response[i].BidDueDates);
                        $(".bidreqstatus", cln).html('<span class="badge badge-primary">' + response[i].BidReqStatus+'</span>');
                        $(".alinkbidview", cln).attr('href', '../VendorManager/ViewBidRequest?BidRequestKey=' + response[i].BidRequestKey + '&CompanyKey=' + $('#Vendor_CompanyKey').val());

                        $(cln).append("<input type='hidden' name='brk' value='" + response[i].BidRequestKey + "'/>");
                        $("#bidRequestTable ").append(cln);
                    }

                    $("#bidRequestTable tbody tr:eq(0)").hide();
                    //updatePaging(response[i].TotalRecord,"bidRequest");
                }
            });
        }
        function bindWorkOrder() {
            debugger;
            $.ajax({

                url: '@Url.Action("BindWorkOrder", "VendorManager")',
                cache: false,
                data:
                {
                    CompanyKey: $('#Vendor_CompanyKey').val(),
                    pageSize: $('#PageSizeW').val(),
                    index: $('#HdnPageIndexW').val(),
                    Search: "",
                    sort: $("#HdnSortValueW").val()
                },
                success: function (response) {
                    debugger;
                    $("#workOrderTable tbody tr:not(:first)").remove();
                    $("#workOrderTable tbody tr:eq(0)").show();
                    for (var i = 0; i < response.length; i++) {
                        var cln = $("#workOrderTable tbody tr:eq(0)").clone(true);
                        $(".worktitle", cln).html(response[i].Title);
                        $(".workproperty", cln).html(response[i].Property);
                        $(".workstartdate", cln).html(response[i].StartDates);
                        $(".workduedate", cln).html(response[i].BidDueDates);
                        $(".workstatus", cln).html('<span class="badge badge-primary">' + response[i].BidReqStatus +'</span>');
                        $(".worklink", cln).attr('href', '/VendorManager/ViewWorkOrder?BidRequestKey=' + response[i].BidRequestKey + '&CompanyKey=' + $('#Vendor_CompanyKey').val());

                        $(cln).append("<input type='hidden' name='brk' value='" + response[i].BidRequestKey + "'/>");
                        $("#workOrderTable ").append(cln);
                    }

                    $("#workOrderTable ").append(cln);


                    $("#workOrderTable tbody tr:eq(0)").hide();
                    //updatePaging(response[i].TotalRecord, "Work");
                }
            });
        }
        function updatePaging(TotalRecs,tab) {
            $('ul.pagination').html('');
            var liClone = $('ul.pagination');
            var pageSize = $('#PageSize').val();
            var index = $('#HdnPageIndex').val();
            if (tab == "Work") {
                liClone = $('ul.paginationW');
                pageSize = $('#PageSizeW').val();
                index = $('#HdnPageIndexW').val();
            }
            debugger;

            var NoPage = 1;
            if (parseInt(TotalRecs) > parseInt(pageSize)) {
                NoPage = parseInt(parseInt(TotalRecs) / parseInt(pageSize));
                if (parseFloat(parseInt(parseInt(TotalRecs) / parseInt(pageSize))) < parseFloat(parseInt(TotalRecs) / parseInt(pageSize))) {
                    NoPage = (parseInt(parseInt(TotalRecs) / parseInt(pageSize)) + 1);
                }
            }

            var lp = 0;//parseFloat(parseInt($('#HdnPageIndex').val()) / 5);
            if (parseFloat(parseInt(index) % 5) == 0) {
                lp = ((parseInt(parseInt(index) / 5) - 1) * 5);
            } else {
                lp = parseInt(parseInt(index) / 5) * 5;
            }

            var ind = 0;
            for (var i = 1; i <= NoPage; i++) {
                if ((parseInt(lp)) < i) {
                    if (parseInt(index) > 5 && $(liClone).find('li.previous').length == 0) {
                        $(liClone).append('<li class="paginate_button previous" aria-controls="DataTables_Table_0" tabindex="0" onclick="LoadPagingSortTableFill(' + "'" + (i - 1) + "'" + ')"><a href="#">Previous</a></li>');
                    }
                    if (ind < 5) {
                        if (i == parseInt(index)) {
                            $(liClone).append('<li style=""><a href="#" onclick="LoadPagingSortTableFill(' + "'" + i + "'" + ')" class="current">' + i + '</a></li>');
                        } else {
                            $(liClone).append('<li style=""><a href="#" onclick="LoadPagingSortTableFill(' + "'" + i + "'" + ')">' + i + '</a></li>');
                        }
                    } else if ($(liClone).find('li.next').length == 0) {
                        $(liClone).append('<li class="paginate_button next " aria-controls="DataTables_Table_0" tabindex="0" onclick="LoadPagingSortTableFill(' + "'" + i + "'" + ')"><a href="#">Next</a></li>');
                    }
                    ind = ind + 1;
                }
            }



        }
        @*function LoadPagingSortTableFill(pageIndex)
        {
        debugger;
        $('#HdnPageIndex').val(pageIndex);
        $.ajax({
            url: '@Url.Action("IndexvendorPaging", "VendorManager")',
            cache: false,
            data: {
                PageSize: $('#PageSize').val(),
                PageIndex: pageIndex,
                Search: $('#txtsearch').val(),
                Sort: $("#HdnSortValue").val()
            },
            success: function (response)
            {
                debugger;
                if (parseInt(response.length) > 0) {

                    var curRecords = 0;
                    var TotalRecs = 0;
                    debugger;
                    curRecords = parseInt(($('#HdnPageIndex').val()) * parseInt($('#PageSize').val()));
                    curRecords = curRecords - ($('#PageSize').val() - parseInt(response.length));
                    TotalRecs = parseInt(response[0].TotalRecords);
                    $('.spnOfRecs').text(curRecords);
                    $('.spnTotalRecs').text(TotalRecs);

                } else {

                }
                $("#RawDatas table tbody tr:not(:first)").remove();
                $("#RawDatas table tbody tr:eq(0)").show();
                for (var i = 0; i < response.length; i++)
                {
                    var table = $("#RawDatas table tbody tr:eq(0)").clone(true);
                    $(".name", table).html(response[i].LegalName);
                    $(".work", table).html(response[i].Work);
                    $(".title", table).html(response[i].Title);
                    $("#viewdata", table).attr('href', '/VendorManager/VendorView?CompanyKey=' + response[i].CompanyKey);

                    $("#RawDatas table").append(table);
                }
                $("#RawDatas table tbody tr:eq(0)").hide();
                updatePaging(response[0].TotalRecords);
                $("#loading1").hide();
            }
        });
    }*@
</script>


