@model AssociationBids.Portal.Model.VendorModel
@{
    ViewBag.Title = "PMVendorlist";
    Layout = "~/Views/Shared/_PropertyManagerLayout.cshtml";
    string Errormessage = Convert.ToString(ViewData["Errormessage"]);
}
<script src="../assets/js/vendors/jquery-3.2.1.min.js"></script>

<style>
    div#ServiceTitle1_chosen {
        width: 100% !important;
    }

    div#Title_chosen {
        width: 100% !important;
    }

    .selector_ED {
        width: auto !important;
    }

    div#pagin {
        margin-right: 20px;
    }

    .chosen-container-multi .chosen-choices li.search-choice .search-choice-close {
        background: url('../../Content/themes/cancelimg.jpg');
    }

    .chosen-select placeholder_text {
        padding: 5px;
    }

    .Error {
        color: red;
    }
</style>

<h2>PMVendorlist</h2>

<!-- app-content-->
<div class="app-content  my-3 my-md-5">
    <div class="side-app">
        <div class="page-header">
            <ol class="breadcrumb">
                <!-- breadcrumb -->
                <li class="breadcrumb-item ">
                    @Html.ActionLink("Home", "Dashboard", "PMDashboard", null, new { })
                </li>
                <li class="breadcrumb-item active text-left">Vendors</li>
            </ol><!-- End breadcrumb -->
        </div>
        @if (TempData["Sucessmessage"] != null)
        {
            <p class="alert alert-success alert-dismissible" id="successMessage">
                @TempData["Sucessmessage"]
                <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
            </p>
        }
        @if (TempData["delete"] != null)
        {
            <p class="alert alert-danger alert-dismissible" id="successMessage">
                @TempData["delete"]
                <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
            </p>
        }

        <div role="alert">
            @*<div class="alert alert-danger" id="Error" style="display: none;margin-top: 20px;">
                    <strong><span class="errormessage"></span></strong>
                </div>*@
            @if (!string.IsNullOrEmpty(Errormessage))
            {
                <div class="alert alert-danger" style="margin-top: 20px;">
                    <strong><span>@Errormessage</span></strong>
                </div>
            }
        </div>


        @*<div class="alert alert-danger" id="Error" style="display: none;margin-top: 20px;">
                <strong><span class="errormessage"></span></strong>
            </div>*@





        @*<div class="alert alert-success alert-dismissible"  id="SuccessMessagess" style=" display:none;">
                        <strong><span>Vendor Status Updated Successfully</span> <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a></strong>


            </div>*@





        <!-- End page-header -->

        <div class="row">
            <div class="col-md-12 grid-margin stretch-card">
                <div class="card">
                    <div class="alert alert-danger" id="Error" style="display:none; margin-top: 20px;">
                        <strong><span class="errormessage"></span></strong>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <div class="row">

                                <div class="col-lg-3 col-xl-4">
                                    <input type="text" id="txtsearch" class="form-control" placeholder="Search For...">
                                </div>

                                <div class="col-lg-3 col-xl-4">
                                    <a class="btn btn-secondary" id="btnsearch" href="#" role="button">Search</a>
                                    <span class="advance_search btn_advsearch" onclick="toggle_visibility('advancesearch2');"><i class="fe fe-chevron-down"></i></span>
                                </div>
                                <div class="col-lg-3 col-xl-2" style="display: none;">
                                    <div class="btn_group_div text-right">
                                        <a href="map_vendors.html" class="btn btn-sm btn-info"><i class="fa fa-map-marker"></i> Show Map</a>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-xl-4">
                                    <div class="btn_group_div text-right">
                                        <a href="~/PMVendor/PMVendorAdd" class="btn btn-primary pull-right" title="Invite Vendor">+ Invite Vendor</a>
                                    </div>
                                </div>

                            </div>
                        </div><!-- end of form group -->

                        <div id="advancesearch3">
                            <div class="overlayclose"><i class="fa fa-times"></i></div>
                            <div class="overlayclose"><i class="fa fa-times"></i></div>
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-md-3">
                                        <label class="form-label">Vendor Name</label>
                                        <input class="form-control" id="txtName" placeholder="Vendor Name" />
                                    </div>
                                    <div class="col-md-3">
                                        <label class="form-label">Service</label>

                                        @Html.DropDownListFor(model => model.ServiceTitle1, new SelectList(ViewBag.lstservice, "Value", "Text"), new { @class = "form-control" })

                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label">Status</label>
                                        <select class="form-control" id="statusval">
                                            <option value="1">All</option>
                                            <option value="2">Star</option>
                                            <option value="3">Invited</option>
                                            <option value="4">Duplicate</option>
                                        </select>
                                    </div>

                                    <div class="col-md-3">
                                        <label class="form-label">&nbsp;</label>
                                        <button type="button" id="btnsearchVendor" class="btn btn-primary btn-icon-text">
                                            Search
                                        </button>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <hr />
                        <div id="RawDatas" class="table-responsive" style="display:block">
                            <table id="dataTableExample" class="table table-striped table-bordered text-nowrap w-100 dataTable no-footer">
                                <thead>
                                    <tr>
                                        <th width="30%" onclick="SortingFun('Name');" style="cursor: pointer;">
                                            <i id="Namei" class="fa fa-sort-asc pull-right"></i>
                                            Vendor Name
                                        </th>
                                        <th width="30%" onclick="SortingFun('Work');" style="cursor: pointer;">
                                            <i id="Worki" class="fa fa-sort-asc pull-right"></i>
                                            Contact Person
                                        </th>
                                        <th width="30%" onclick="SortingFun('Title');" style="cursor: pointer;">
                                            <i id="Titlei" class="fa fa-sort-asc pull-right"></i>
                                            Service
                                        </th>
                                        <th width="30%" onclick="SortingFun('star');" style="cursor:pointer;">
                                            <i id="Favoritei" class="fa fa-sort-asc pull-right"></i>
                                            Status
                                        </th>
                                        <th width="10%">
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><span class="name"></span></td>
                                        <td><span class="work"></span></td>
                                        <td><span class="title"></span></td>
                                        <td align="center" class="text-center">
                                            <a id="Status" role="button">
                                                <span class="text-success" title=""><i id="fav" class="fa fa-star" style="cursor:pointer;"title="Mark as unstar"></i></span>

                                                <span class="text-success" title=""><i id="unstar" class="fa fa-star-o" style="cursor:pointer; font-size:13px;" title="Mark as star"></i></span>
                                                <span style=""><i id="invite" style="font-size:15px; font-weight:bold"></i></span>
                                            </a>
                                        </td>
                                        @*<td align="center"><a href="#"><i id="fav" class="fa fa-star"></i></a></td>*@
                                        <td align="center"><a id="viewdata" title="View Details" role="button"><i class="fe fe-eye font18"></i></a></td>
                                    </tr>
                                </tbody>
                            </table>
                            <div class="pull-left">
                                <label><span class="spnToRecs">0</span> to  <span class="spnOfRecs">0</span> out of <span class="spnTotalRecs">0</span>&nbsp; Records </label>
                            </div>
                            <div class="dataTables_paginate paging_simple_numbers" id="pagin">
                                <ul class="pagination"></ul>
                            </div>
                        </div>
                    </div>
                    <div class="pagination" style="display:none;">
                        <input type="hidden" id="HdnSortValue" value="order by Name asc" />
                        <input type="hidden" id="HdnPageIndex" value="1" />
                        <input type="hidden" id="PageSize" value="10" />
                        <input type="hidden" id="Namehdn" value="asc" />
                        <input type="hidden" id="Workhdn" value="asc" />
                        <input type="hidden" id="Starhdn" value="asc" />
                        <input type="hidden" id="Titlehdn" value="asc" />
                        <input type="hidden" id="TotalPageRecord" value='0' />
                    </div>
                </div>
            </div>
        </div>
    </div><!--End side app-->
    <!--footer-->
    <footer class="footer">
        <div class="container">
            <div class="row align-items-center flex-row-reverse">
                <div class="col-lg-12 col-sm-12   text-center">
                    Copyright © 2020 Association Bids. All rights reserved.
                </div>
            </div>
        </div>
    </footer>
    <!-- End Footer-->

</div>
<!-- End app-content-->
@* </div>*@
<script type="text/javascript">
    $(document).ready(function () {
        debugger;
        $("global-loader").show();
        $(".advance_search").click(function () {
            $("#advancesearch2").toggle(500);
        });
        $(".overlayclose").click(function () {
            $("#advancesearch2").hide();
        });
        $(".chosen-select").chosen();
        $('.loader-wrapper').show();
        LoadSortTableFill();
        var sorted = 'order by Name asc';
        $("#SortValuee").val(sorted);
        $('#divSuccess').hide();
        checkPoratl();

        $("global-loader").hide();
        $("#SuccessMessagess").hide();
    });

  function checkPoratl()
         {
         $.ajax({
            url: '@Url.Action("checkPortal", "PMProperties")',
            cache: false,
             data:
             {
              PropertyKey: $('#PropertyKey').val()
            },
            success: function (response)
            {
                debugger;

                if (response == false) {
                     window.location.href = '@Url.Action("Index", "Login")';
                }
                else {

                }
            }
        });
    }

 function updatePaging(TotalRecs) {
            $('ul.pagination').html('');
            var liClone = $('ul.pagination');
     debugger;
      var pageSize = '@System.Configuration.ConfigurationManager.AppSettings["PageSize"].ToString()';
            //var pageSize = $('#PageSize').val();
            var NoPage = 1;
            if (parseInt(TotalRecs) > parseInt(pageSize)) {
                NoPage = parseInt(parseInt(TotalRecs) / parseInt(pageSize));
                if (parseFloat(parseInt(parseInt(TotalRecs) / parseInt(pageSize))) < parseFloat(parseInt(TotalRecs) / parseInt(pageSize))) {
                    NoPage = (parseInt(parseInt(TotalRecs) / parseInt(pageSize)) + 1);
                }
            }

            var lp = 0;//parseFloat(parseInt($('#HdnPageIndex').val()) / 5);
            if (parseFloat(parseInt($('#HdnPageIndex').val()) % 5) == 0) {
                lp = ((parseInt(parseInt($('#HdnPageIndex').val()) / 5) - 1) * 5);
            } else {
                lp = parseInt(parseInt($('#HdnPageIndex').val()) / 5) * 5;
            }

            var ind = 0;
            for (var i = 1; i <= NoPage; i++) {
                if ((parseInt(lp)) < i) {
                    if (parseInt($('#HdnPageIndex').val()) > 5 && $(liClone).find('li.previous').length == 0) {
                        $(liClone).append('<li class="paginate_button previous" aria-controls="DataTables_Table_0" tabindex="0" onclick="LoadPagingSortTableFill(' + "'" + (i - 1) + "'" + ')"><a href="#">Previous</a></li>');
                    }
                    if (ind < 5) {
                        if (i == parseInt($('#HdnPageIndex').val())) {
                            $(liClone).append('<li style=""><a href="#" onclick="LoadPagingSortTableFill(' + "'" + i + "'" + ')" class="current">' + i + '</a></li>');
                        } else {
                            $(liClone).append('<li style=""><a href="#" onclick="LoadPagingSortTableFill(' + "'" + i + "'" + ')">' + i + '</a></li>');
                        }
                    } else if ($(liClone).find('li.next').length == 0) {
                        $(liClone).append('<li class="paginate_button next " aria-controls="DataTables_Table_0" tabindex="0" onclick="LoadPagingSortTableFill(' + "'" + i + "'" + ')"><a href="#">Next</a></li>');
                    }
                    ind = ind + 1;
                }
            }
        }

    function LoadPagingSortTableFill(pageIndex)
        {
             var pageSize = '@System.Configuration.ConfigurationManager.AppSettings["PageSize"].ToString()';

            var txtName = $('#txtName').val();
            var textsearch = $('#txtsearch').val();
            var txtTitle = $('#ServiceTitle1 option:selected').text();
            var status = $("#statusval").val();
            if (txtName == "") {
                var txt = $('#txtsearch').val();

            }

            else if (textsearch == "") {
                var txt = $('#txtName').val();

            }
            var star = "";
            var invite = "";
            var Duplicate = "";


            if (status == 1) {
                star = null;
                invite = null;
                Duplicate = null;
            }

            if (status == 2) {
                star = "1";
                invite = null;
                Duplicate = null;
            }


            if (status == 3) {
                star = null;
                invite = 1;
                Duplicate = null;
            }
        if (status == 4) {
            star = null;
            invite = null;
            Duplicate = 1;
        }

        debugger;
        $('#HdnPageIndex').val(pageIndex);
        $.ajax({
            url: '@Url.Action("IndexvendorPaging", "PMVendor")',
            cache: false,
            data: {
                PageSize: pageSize,
                PageIndex: $('#HdnPageIndex').val(),
                Search: txt,
                Sort: $("#HdnSortValue").val(),
                service: txtTitle,
                checkstar: star,
                Invited: invite,
                Duplicate: Duplicate
            },
            success: function (response)
            {
                debugger;

                $('.spnOfRecs').text(0);
                $('.spnTotalRecs').text(0);
                $('.spnToRecs').text(0);

                if (parseInt(response.length) > 0) {

                    var curRecords = 0;
                    var TotalRecs = 0;
                    var spnToRecs = 0;
                    var invite = "invited";
                    var Duplicate = "Duplicate";
                    debugger;
                    curRecords = parseInt(($('#HdnPageIndex').val()) * parseInt(pageSize));
                    curRecords = curRecords - (pageSize - parseInt(response.length));
                    TotalRecs = parseInt(response[0].TotalRecords);
                    $('.spnOfRecs').text(curRecords);
                    $('.spnTotalRecs').text(TotalRecs);

                } else {

                }
                $("#RawDatas table tbody tr:not(:first)").remove();
                $("#RawDatas table tbody tr:eq(0)").show();


                    for (var i = 0; i < response.length; i++) {
                        debugger;
                        var table = $("#RawDatas table tbody tr:eq(0)").clone(true);
                        $(".name", table).html(response[i].LegalName);
                        $(".work", table).html(response[i].Work);
                        $(".title", table).html(response[i].Title);

                        if (response[i].star == "1") {
                            $("#invite", table).css("display", "none");
                            $("#unstar", table).css("display", "none");
                            $("#fav", table).css("color", "green");
                        }
                        else if (response[i].invited == "1") {
                            $("#invite", table).html(invite);
                            $("#fav", table).css("display", "none");
                            $("#unstar", table).css("display", "none");
                        }
                        else if (response[i].Duplicate == "1") {
                            $("#invite", table).html(Duplicate);
                            $("#fav", table).css("display", "none");
                            $("#unstar", table).css("display", "none");
                        }



                        else {
                            $("#invite", table).css("display", "none");
                            $("#fav", table).css("display", "none");
                            $("#unstar", table).css("display", "block");
                        }
                        $("#unstar", table).addClass('unstar' + response[i].CompanyKey);
                        $("#unstar", table).attr('onclick', 'return InsertData(' + response[i].CompanyKey + ',"unstar' + response[i].CompanyKey + '","unstar");');

                        $("#fav", table).addClass('fav' + response[i].CompanyKey);
                        $("#fav", table).attr('onclick', 'return InsertData(' + response[i].CompanyKey + ',"fav' + response[i].CompanyKey + '","star");');


                        $("#viewdata", table).attr('href', '/PMVendor/VendorView?CompanyKey=' + response[i].CompanyKey);

                        $("#RawDatas table").append(table);
                        spnToRecs++;
                    }
                    $("#RawDatas table tbody tr:eq(0)").hide();


                spnToRecs = (curRecords - spnToRecs) + 1;
                if (spnToRecs > 0) {
                    $('.spnToRecs').text(spnToRecs);
                }
                else {
                    $('.spnToRecs').text(0);
                }
                if (curRecords.text == "NaN") {

                    $('.errormessage').html('Data Is Not Found.');
                    $('#Error').show();
                    $("#RawDatas table thead tr:eq(0)").hide();
                    $("#RawDatas table tbody tr:eq(0)").hide();
                }
                else {
                    updatePaging(response[0].TotalRecords);
                    $("#loading1").hide();
                }
            }
        });
    }


    $("#btnsearch").click(function () {

        $("#loading1").show();
        LoadSortTableFillWithSearch11();
    });

      function updatePagingsearch(TotalRecs, PageIndex) {

        $('ul.pagination').html('');
        var liClone = $('ul.pagination');

            debugger;

            var pageSize = '@System.Configuration.ConfigurationManager.AppSettings["PageSize"].ToString()';
            //var pageSize = $('#PageSize').val();
            var NoPage = 1;
            if (parseInt(TotalRecs) > parseInt(pageSize)) {
                NoPage = parseInt(parseInt(TotalRecs) / parseInt(pageSize));
                if (parseFloat(parseInt(parseInt(TotalRecs) / parseInt(pageSize))) < parseFloat(parseInt(TotalRecs) / parseInt(pageSize))) {
                    NoPage = (parseInt(parseInt(TotalRecs) / parseInt(pageSize)) + 1);
                }
            }

            var lp = 0;//parseFloat(parseInt($('#HdnPageIndex').val()) / 5);
        if (parseFloat(parseInt(PageIndex) % 5) == 0) {
            lp = ((parseInt(parseInt(PageIndex) / 5) - 1) * 5);
            }
            else {
            lp = parseInt(parseInt(PageIndex) / 5) * 5;
            }

            var ind = 0;
            for (var i = 1; i <= NoPage; i++) {
                if ((parseInt(lp)) < i) {
                    if (parseInt(PageIndex) > 5 && $(liClone).find('li.previous').length == 0) {
                        $(liClone).append('<li class="paginate_button previous" aria-controls="DataTables_Table_0" tabindex="0" onclick="LoadPagingSortTableFill(' + "'" + (i - 1) + "'" + ')"><a href="#">Previous</a></li>');
                    }
                    if (ind < 5) {
                        if (i == parseInt(PageIndex)) {
                            $(liClone).append('<li style=""><a href="#" onclick="LoadPagingSortTableFill(' + "'" + i + "'" + ')" class="current">' + i + '</a></li>');
                        } else {
                            $(liClone).append('<li style=""><a href="#" onclick="LoadPagingSortTableFill(' + "'" + i + "'" + ')">' + i + '</a></li>');
                        }
                    } else if ($(liClone).find('li.next').length == 0) {
                        $(liClone).append('<li class="paginate_button next " aria-controls="DataTables_Table_0" tabindex="0" onclick="LoadPagingSortTableFill(' + "'" + i + "'" + ')"><a href="#">Next</a></li>');
                    }
                    ind = ind + 1;
                }
            }



    }
    function LoadSortTableFillWithSearch11() {

        debugger;
        var PageSize = "10";
        var PageIndex = "1";
        var Text = $('#txtsearch').val();
        var invite = "invited";
        var Duplicate = "Duplicate";
        if ($('#txtsearch').val() == "") {
            PageSize = "10";
        }

        $.ajax({
            url: '/PMVendor/IndexvendorPaging',
            cache: false,
            data: {
                PageSize: PageSize,
                PageIndex: PageIndex,
                Search: $('#txtsearch').val(),
                Sort: $("#HdnSortValue").val()
            },
            success: function (response) {
                debugger;

                $('.spnOfRecs').text(0);
                $('.spnTotalRecs').text(0);
                $('.spnToRecs').text(0);

                if (parseInt(response.length) > 0) {

                    var curRecords = 0;
                    var TotalRecs = 0;
                    var spnToRecs = 0;
                    //debugger;
                    curRecords = parseInt((PageIndex) * parseInt(PageSize));
                    curRecords = curRecords - (PageSize - parseInt(response.length));
                    TotalRecs = parseInt(response[0].TotalRecords);
                    $('.spnOfRecs').text(curRecords);
                    $('.spnTotalRecs').text(TotalRecs);

                }
                else {

                }
                $("#RawDatas table tbody tr:not(:first)").remove();

                for (var i = 0; i < response.length; i++) {
                    debugger;
                    var table = $("#RawDatas table tbody tr:eq(0)").clone(true);
                    $(".name", table).html(response[i].LegalName);
                    $(".work", table).html(response[i].Work);
                    $(".title", table).html(response[i].Title);
                    if (response[i].star == "1") {
                        $("#invite", table).css("display", "none");
                        $("#unstar", table).css("display", "none");
                        $("#fav", table).css("color", "green");
                    }
                    else if (response[i].invited == "1") {
                        $("#invite", table).html(invite);
                        $("#fav", table).css("display", "none");
                        $("#unstar", table).css("display", "none");
                    }
                    else if (response[i].Duplicate == "1") {
                        $("#invite", table).html(Duplicate);
                        $("#fav", table).css("display", "none");
                        $("#unstar", table).css("display", "none");
                    }




                    else {
                        $("#invite", table).css("display", "none");
                        $("#fav", table).css("display", "none");
                        $("#unstar", table).css("display", "block");
                    }
                    $("#unstar", table).addClass('unstar' + response[i].CompanyKey);
                    $("#unstar", table).attr('onclick', 'return InsertData(' + response[i].CompanyKey + ',"unstar' + response[i].CompanyKey + '","unstar");');

                    $("#fav", table).addClass('fav' + response[i].CompanyKey);
                    $("#fav", table).attr('onclick', 'return InsertData(' + response[i].CompanyKey + ',"fav' + response[i].CompanyKey + '","star");');

                    $("#viewdata", table).attr('href', '/PMVendor/VendorView?CompanyKey=' + response[i].CompanyKey);
                    $("#RawDatas table").append(table);
                    table.show();
                    spnToRecs++;
                }
                $("#RawDatas table tbody tr:eq(0)").hide();

                spnToRecs = (curRecords - spnToRecs) + 1;
                if (spnToRecs > 0) {
                    $('.spnToRecs').text(spnToRecs);
                    $(".pagination").show();
                    $("#RawDatas table thead tr:eq(0)").show();
                   
                    updatePagingsearch(TotalRecs, PageIndex);
                    $('#Error').hide();
                }
                else {
                    $('.spnToRecs').text(0);
                    updatePagingsearch(TotalRecs, PageIndex);
                    if (TotalRecs = 'undefined') {
                        $('.errormessage').html('Data Not Found.');
                        $('#Error').show();
                        $("#RawDatas table thead tr:eq(0)").hide();
                        $("#RawDatas table tbody tr:eq(0)").hide();
                        $(".pagination").hide();
                    }
                }
                debugger;



                updatePagingsearch(TotalRecs, PageIndex);

            }
        });
    }


    $("#btnsearchVendor").click(function () {

        $("#advancesearch3").hide();
        LoadSortTableFillWithSearch();
    });

     function LoadSortTableFill() {
         debugger;
         //
         $("#RawDatas table tbody tr:eq(0)").hide();
         //
         var pageSize = '@System.Configuration.ConfigurationManager.AppSettings["PageSize"].ToString()';

         var txtName = $('#txtName').val();
         var textsearch = $('#txtsearch').val();
         if (txtName == "") {
             var txt = $('#txtsearch').val();

         }

         else if (textsearch == "") {
             var txt = $('#txtName').val();

         }

        $.ajax({
            url: '@Url.Action("IndexvendorPaging", "PMVendor")',
            cache: false,
            data: {
                PageSize: pageSize,
                PageIndex: $('#HdnPageIndex').val(),
                Search: txt,
                Sort: $("#HdnSortValue").val(),
            },
            success: function (response)
            {
                debugger;

                $('.spnOfRecs').text(0);
                $('.spnTotalRecs').text(0);
                $('.spnToRecs').text(0);

                if (parseInt(response.length) > 0) {

                    var curRecords = 0;
                    var TotalRecs = 0;
                    var spnToRecs = 0;
                    var invite = "invited";
                    var Duplicate = "Duplicate";
                    debugger;
                    curRecords = parseInt(($('#HdnPageIndex').val()) * parseInt(pageSize));
                    curRecords = curRecords - (pageSize - parseInt(response.length));
                    TotalRecs = parseInt(response[0].TotalRecords);
                    $('.spnOfRecs').text(curRecords);
                    $('.spnTotalRecs').text(TotalRecs);

                } else {

                }
                $("#RawDatas table tbody tr:not(:first)").remove();
                //$("#RawDatas table tbody tr:eq(0)").show();

                    for (var i = 0; i < response.length; i++) {
                        debugger;
                        var table = $("#RawDatas table tbody tr:eq(0)").clone(true);
                        $(".name", table).html(response[i].LegalName);
                        $(".work", table).html(response[i].Work);
                        $(".title", table).html(response[i].Title);
                        if (response[i].star == "1") {
                            $("#invite", table).css("display", "none");
                            $("#unstar", table).css("display", "none");
                            $("#fav", table).css("color", "green");
                        }
                        else if (response[i].invited == "1") {
                            $("#invite", table).html(invite);
                            $("#fav", table).css("display", "none");
                            $("#unstar", table).css("display", "none");
                        }
                        else if (response[i].Duplicate == "1") {
                            $("#invite", table).html(Duplicate);
                            $("#fav", table).css("display", "none");
                            $("#unstar", table).css("display", "none");
                        }


                        else {
                            $("#invite", table).css("display", "none");
                            $("#fav", table).css("display", "none");
                            $("#unstar", table).css("display", "block");
                        }
                        $("#unstar", table).addClass('unstar' + response[i].CompanyKey);
                        $("#unstar", table).attr('onclick', 'return InsertData(' + response[i].CompanyKey + ',"unstar' + response[i].CompanyKey + '","unstar");');

                        $("#fav", table).addClass('fav' + response[i].CompanyKey);
                        $("#fav", table).attr('onclick', 'return InsertData(' + response[i].CompanyKey + ',"fav' + response[i].CompanyKey + '","star");');

                      $("#viewdata", table).attr('href', '/PMVendor/VendorView?CompanyKey=' + response[i].CompanyKey);
                        $("#RawDatas table").append(table);
                        table.show();
                    spnToRecs++;
                }
                $("#RawDatas table tbody tr:eq(0)").hide();


                spnToRecs = (curRecords - spnToRecs) + 1;
                    if (spnToRecs > 0) {
                        $('.spnToRecs').text(spnToRecs);
                        $(".pagination").show();
                        $('#Error').hide();
                    }
                    else {
                        $('.spnToRecs').text(0);

                        $('.errormessage').html('Data Is Not Found.');
                        $('#Error').show();
                        $("#RawDatas table thead tr:eq(0)").hide();
                        $("#RawDatas table tbody tr:eq(0)").hide();
                        $(".pagination").hide();
                    }

                updatePaging(response[0].TotalRecords);
                    $("#loading1").hide();

            }
        });
    }
    function Getdata() {

        $("#divSucces").hide();
        $("#divSucces").html('');
        $("#divError").hide();
        $("#divError").html('');
        $("#loading1").show();


        GetRecords();
    }
    function GetRecords() {
         var pageSize = '@System.Configuration.ConfigurationManager.AppSettings["PageSize"].ToString()';

        var txtTitle = $('#ServiceTitle1 option:selected').text();
        var txtfav = "";
        var txtName = $('#txtName').val();
        var textsearch = $('#txtsearch').val();
        if (txtName == "") {
            var txt = $('#txtsearch').val();

        }

        else if (textsearch == "") {
            var txt = $('#txtName').val();

        }
        if ($('#chkfav').prop("checked")) {
            txtfav = "1"
        }
        else {
            txtfav = "0";
        }

        debugger;
        var CountVal = (parseInt($('#HdnPageIndex').val()) + 1);
        $('#HdnPageIndex').val();
        pageSize = parseInt(pageSize * CountVal);

        $("#loading1").show();
        $.ajax({
            type: "Get",
            url: "/PMVendor/IndexvendorPaging",
            data:
            {
                PageSize: pageSize,
                PageIndex: $('#HdnPageIndex').val(),
                Search: txt,
                Sort: $("#HdnSortValue").val(),
                service: txtTitle,
                checkstar: txtfav,
            },
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: OnSuccess,
            failure: function (response) {
            },
            error: function (response) {
            }
        });
    }

    function LoadSortTableFillWithSearch()
    {
         var pageSize = '@System.Configuration.ConfigurationManager.AppSettings["PageSize"].ToString()';
        debugger;

        var txtName = $('#txtName').val();
        var textsearch = $('#txtsearch').val();
        if (txtName == "") {
            var txt = $('#txtsearch').val();

        }

        else if (textsearch == "") {
            var txt = $('#txtName').val();

        }
        var txtTitle = $('#ServiceTitle1 option:selected').text();
        var status = $("#statusval").val();
        var star = "";
        var invite = "";


        if (status == 1) {
            star = null;
            invite = null;
            Duplicate = null;
        }

        if (status == 2) {
            star = "1";
            invite = null;
            Duplicate = null;
        }


        if (status == 3) {
            star = null;
            invite = 1;
            Duplicate = null;
        }
        if (status == 4) {
            star = null;
            invite = null;
            Duplicate = 1;
        }


        $.ajax({
            url: '/PMVendor/IndexvendorPaging',
            cache: false,
            data: {
                PageSize: pageSize,
                PageIndex: $('#HdnPageIndex').val(),
                Search: txt,
                Sort: $("#HdnSortValue").val(),
                service: txtTitle,
                checkstar: star,
                Invited: invite,
                Duplicate: Duplicate
            },
            success: function (response) {

                $('.spnOfRecs').text(0);
                $('.spnTotalRecs').text(0);
                $('.spnToRecs').text(0);

                if (response.length > 0) {
                    var curRecords = 0;
                    var TotalRecs = 0;
                    var spnToRecs = 0;
                    var invite = "invited";
                    var Duplicate = "Duplicate";
                    debugger;
                    curRecords = parseInt(($('#HdnPageIndex').val()) * parseInt(pageSize));
                    curRecords = curRecords - (pageSize - parseInt(response.length));
                    TotalRecs = parseInt(response[0].TotalRecords);
                    $('.spnOfRecs').text(curRecords);
                    $('.spnTotalRecs').text(TotalRecs);

                }
                else {
                    $('.spnOfRecs').text(0);
                    $('.spnTotalRecs').text(0);
                }
                $("#RawDatas table tbody tr:not(:first)").remove();
                $("#RawDatas table tbody tr:eq(0)").show();

                    for (var i = 0; i < response.length; i++) {
                        var table = $("#RawDatas table tbody tr:eq(0)").clone(true);
                        $(".name", table).html(response[i].LegalName);
                        $(".work", table).html(response[i].Work);
                        $(".title", table).html(response[i].Title);
                        if (response[i].star == "1") {
                            $("#invite", table).css("display", "none");
                            $("#unstar", table).css("display", "none");
                            $("#fav", table).css("color", "green");
                        }
                        else if (response[i].invited == "1") {
                            $("#invite", table).html(invite);
                            $("#fav", table).css("display", "none");
                            $("#unstar", table).css("display", "none");
                        }
                        else if (response[i].Duplicate == "1") {
                            $("#invite", table).html(Duplicate);
                            $("#fav", table).css("display", "none");
                            $("#unstar", table).css("display", "none");
                        }



                        else {
                            $("#invite", table).css("display", "none");
                            $("#fav", table).css("display", "none");
                            $("#unstar", table).css("display", "block");
                        }


                        $("#unstar", table).addClass('unstar' + response[i].CompanyKey);
                        $("#unstar", table).attr('onclick', 'return InsertData(' + response[i].CompanyKey + ',"unstar' + response[i].CompanyKey + '","unstar");');

                        $("#fav", table).addClass('fav' + response[i].CompanyKey);
                        $("#fav", table).attr('onclick', 'return InsertData(' + response[i].CompanyKey + ',"fav' + response[i].CompanyKey + '","star");');

                        $("#viewdata", table).attr('href', '/PMVendor/VendorView?CompanyKey=' + response[i].CompanyKey);
                        $("#RawDatas table").append(table);
                        spnToRecs++;
                    }


                    $("#RawDatas table tbody tr:eq(0)").hide();


                spnToRecs = (curRecords - spnToRecs) + 1;
                if (spnToRecs > 0) {
                    $('.spnToRecs').text(spnToRecs);
                    $('.pagination').show();
                    $('#Error').hide();
                }
                else {
                    $('.spnToRecs').text(0);
                    $('.pagination').hide();
                    $('.errormessage').html('Data Is Not Found.');
                    $('#Error').show();
                    $("#RawDatas table thead tr:eq(0)").hide();
                    $("#RawDatas table tbody tr:eq(0)").hide();
                }
                if (curRecords == 0) {

                    $('.errormessage').html('Data Is Not Found.');
                    $('#Error').show();
                    $("#RawDatas table thead tr:eq(0)").hide();
                    $("#RawDatas table tbody tr:eq(0)").hide();
                }
                else {
                    updatePaging(response[0].TotalRecords);
                }
            }
        });
    }

    function SortingFun(val) {

        $('#HdnPageIndex').val('1');
        var Sort = $('#SortValue').val();
        debugger;
        var ascdesc = 'fa-sort-asc';
        var ascdesc1 = 'fa-sort-desc';
        var ascdesc3 = 'fa-sort-asc';
        var ascdesc4 = 'fa-sort-desc';

        $('.loader-wrapper').show();
        var Sort = '';
        $('#HdnPageIndex').val('1');
        $('#Namei').removeClass(ascdesc4);
        $('#Namei').addClass(ascdesc3);

        $('#Worki').removeClass(ascdesc4);
        $('#Worki').addClass(ascdesc3);

        $('#Titlei').removeClass(ascdesc4);
        $('#Titlei').addClass(ascdesc3);

        $('#stari').removeClass(ascdesc4);
        $('#stari').addClass(ascdesc3);


        debugger;
        //-----------------------------------------------------------
        if (val == 'Name') {
            if ($('#Namehdn').val() == 'asc') {
                Sort = 'order by Name desc';
                $('#Namehdn').val('desc');
                $('#Namei').removeClass(ascdesc);
                $('#Namei').addClass(ascdesc1);
            }
            else {
                Sort = 'order by Name asc';
                $('#Namehdn').val('asc');
                $('#Namei').removeClass(ascdesc1);
                $('#Namei').addClass(ascdesc);
            }
        }
        if (val == 'star') {
            if ($('#Starhdn').val() == 'asc') {
                Sort = 'order by star desc';
                $('#Starhdn').val('desc');
                $('#stari').removeClass(ascdesc);
                $('#stari').addClass(ascdesc1);
            }
            else {
                Sort = 'order by star asc';
                $('#Starhdn').val('asc');
                $('#stari').removeClass(ascdesc1);
                $('#stari').addClass(ascdesc);
            }
        }

        //-------------------------------------------------
        if (val == 'Work') {
            if ($('#Workhdn').val() == 'asc') {
                Sort = 'order by Work desc';
                $('#Workhdn').val('desc');
                $('#Worki').removeClass(ascdesc);
                $('#Worki').addClass(ascdesc1);
            }
            else {
                Sort = 'order by Work asc';
                $('#Workhdn').val('asc');
                $('#Worki').removeClass(ascdesc1);
                $('#Worki').addClass(ascdesc);
            }
        }
        //-------------------------------------------------------
        if (val == 'Title') {
            if ($('#Titlehdn').val() == 'asc') {
                Sort = 'order by SeriveTitle desc';
                $('#Titlehdn').val('desc');
                $('#Titlei').removeClass(ascdesc);
                $('#Titlei').addClass(ascdesc1);
            }
            else {
                Sort = 'order by SeriveTitle asc';
                $('#Titlehdn').val('asc');
                $('#Titlei').removeClass(ascdesc1);
                $('#Titlei').addClass(ascdesc);
            }
        }

        $("#HdnSortValue").val(Sort);
        $('.loader-wrapper').show();
        LoadSortTableFill();
    }



    function InsertData(companyKey,classid, status)
    {
        debugger;





        if (status == "unstar")

        {


            $('.' + classid).css('color', 'green');

        }

        if (status == "star")

        {
            $('.' + classid).css('color', '');
        }


         $.ajax({
            url: '@Url.Action("MarkstarOrNotforList", "PMVendor")',
            cache: false,
             data:
             {
                 CompanyKey: companyKey,
            },
            success: function (response)
            {

                debugger;

                if (response == true) {


                    LoadSortTableFillWithSearch();
                }
                else {

                }
            }
        });
    }




    function OnSuccess(response) {
         var pageSize = '@System.Configuration.ConfigurationManager.AppSettings["PageSize"].ToString()';
        debugger;

        $('.spnOfRecs').text(0);
        $('.spnTotalRecs').text(0);
        $('.spnToRecs').text(0);

        if (parseInt(response.length) > 0) {
            var curRecords = 0;
            var TotalRecs = 0;
            var spnToRecs = 0;
            var invite = "invited";
            var Duplicate = "Duplicate";
            debugger;
            curRecords = parseInt(($('#HdnPageIndex').val()) * parseInt(pageSize));
            curRecords = curRecords - (pageSize - parseInt(response.length));
            TotalRecs = parseInt(response[0].TotalRecords);
            $('.spnOfRecs').text(curRecords);
            $('.spnTotalRecs').text(TotalRecs);
        } else {

        }
        $("#RawDatas table tbody tr:not(:first)").remove();
        $("#RawDatas table tbody tr:eq(0)").show();

            for (var i = 0; i < response.length; i++) {
                var table = $("#RawDatas table tbody tr:eq(0)").clone(true);
                $(".name", table).html(response[i].LegalName);
                $(".work", table).html(response[i].Work);
                $(".title", table).html(response[i].Title);
                if (response[i].star == "1") {
                    $("#invite", table).css("display", "none");
                    $("#unstar", table).css("display", "none");
                    $("#fav", table).css("color", "green");
                }
                else if (response[i].invited == "1") {
                    $("#invite", table).html(invite);
                    $("#fav", table).css("display", "none");
                    $("#unstar", table).css("display", "none");
                }
                else if (response[i].Duplicate == "1") {
                    $("#invite", table).html(Duplicate);
                    $("#fav", table).css("display", "none");
                    $("#unstar", table).css("display", "none");
                }


                else {
                    $("#invite", table).css("display", "none");
                    $("#fav", table).css("display", "none");
                    $("#unstar", table).css("display", "block");
                }
                $("#unstar", table).addClass('unstar' + response[i].CompanyKey);
                $("#unstar", table).attr('onclick', 'return InsertData(' + response[i].CompanyKey + ',"unstar' + response[i].CompanyKey + '","unstar");');

                $("#fav", table).addClass('fav' + response[i].CompanyKey);
                $("#fav", table).attr('onclick', 'return InsertData(' + response[i].CompanyKey + ',"fav' + response[i].CompanyKey + '","star");');
                $("#viewdata", table).attr('href', '/PMVendor/VendorView?CompanyKey=' + response[i].CompanyKey);
                $("#RawDatas table").append(table);

                spnToRecs++;
            }

        $("#RawDatas table tbody tr:eq(0)").hide();

        spnToRecs = (curRecords - spnToRecs) + 1;
        if (spnToRecs > 0) {
            $('.spnToRecs').text(spnToRecs);
            $('#pagin').show();
            $('#Error').hide();
        }
        else {
            $('.spnToRecs').text(0);
            $('#pagin').hide();
            $('.errormessage').html('Data Is Not Found.');
            $('#Error').show();
            $("#RawDatas table thead tr:eq(0)").hide();
            $("#RawDatas table tbody tr:eq(0)").hide();

        }
        if (curRecords == 0) {

            $('.errormessage').html('Data Is Not Found.');
            $('#Error').show();
            $("#RawDatas table thead tr:eq(0)").hide();
            $("#RawDatas table tbody tr:eq(0)").hide();
        }
        else {
            updatePaging(response[0].TotalRecords);
            $("#loading1").hide();
        }
    }


</script>